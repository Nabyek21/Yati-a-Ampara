---
---

<header class="flex items-center justify-between p-4 bg-white border-b-2 border-gray-200">
  <button class="text-gray-600 lg:hidden">
    <i class="fas fa-bars text-xl"></i>
  </button>
  <h1 class="text-3xl font-semibold text-purple-800"><slot /></h1>
  <div class="flex items-center space-x-4">
    <div class="relative flex items-center space-x-2">
      <span class="text-gray-700 font-medium" id="admin-name-display">Usuario</span>
      <button id="user-menu-button" class="focus:outline-none">
        <i class="fas fa-user-circle text-2xl text-purple-600"></i>
      </button>

      <!-- Dropdown menu -->
      <div id="profile-logout-menu" class="hidden absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50" style="top: 100%; transform: translateY(8px);">
        <div class="py-2">
          <a href="/admin/profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
            <i class="fas fa-user mr-2"></i>Ver Perfil
          </a>
          <button id="logout-button" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
            <i class="fas fa-sign-out-alt mr-2"></i>Cerrar Sesión
          </button>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Obtener y mostrar el nombre del usuario
    const nameDisplay = document.getElementById('admin-name-display');
    if (nameDisplay) {
      const user = localStorage.getItem('user');
      if (user) {
        try {
          const userData = JSON.parse(user);
          const nombreCompleto = userData.nombres + " " + userData.apellidos;
          nameDisplay.textContent = nombreCompleto;
        } catch (error) {
          console.error('Error al parsear datos del usuario:', error);
          nameDisplay.textContent = 'Usuario';
        }
      } else {
        nameDisplay.textContent = 'Usuario';
      }
    }

    const userMenuButton = document.getElementById('user-menu-button');
    const profileLogoutMenu = document.getElementById('profile-logout-menu');
    const logoutButton = document.getElementById('logout-button');

    if (userMenuButton && profileLogoutMenu && logoutButton) {
      userMenuButton.addEventListener('click', (e) => {
        e.stopPropagation();
        profileLogoutMenu.classList.toggle('hidden');
      });

      // Cierra el dropdown si se hace clic fuera de él
      document.addEventListener('click', (event) => {
        if (!userMenuButton.contains(event.target) && !profileLogoutMenu.contains(event.target)) {
          profileLogoutMenu.classList.add('hidden');
        }
      });

      logoutButton.addEventListener('click', () => {
        localStorage.removeItem('token');
        localStorage.removeItem('user');
        window.location.href = '/login';
      });
    }
  });
</script>
